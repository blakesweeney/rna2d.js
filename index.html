<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <link href='static/css/main.css' rel='stylesheet'>

    <script src='static/jmol/jmol.js'></script>
    <script src='static/js/jquery.min.js'></script>
    <script src='static/js/jquery.jmolTools.js'></script>
    <script src='static/js/sizzle.js'></script>
    <script src='static/js/d3.js'></script>

    <script src='rna2d.js'></script>
  </head>

  <body>

      <!-- Side bar -->
      <div>

      <div id='mode'>
        <label for='mode-checkbox'>Selection Mode</label>
        <div id='mode-button'>
          <input id='mode-checkbox' type='checkbox' value='v' checked='checked'>
        </div>
      </div>

      <div id='motifs'>
        <label for='motif-checkbox'>Show Motifs</label>
        <div id='motif-button'>
          <input id='motif-checkbox' type='checkbox' value='v' checked='checked'>
        </div>
      </div>

      <div id='interaction-controls'>
        <label for='cww-checkbox'>cWW</label>
        <div id='cww-toggle'>
          <input id='cww-checkbox' type='checkbox' value='v' checked='checked'>
        </div>
      </div>

      <!-- <div id='near-controls'> -->
      <!--   <label for='cww-checkbox'>Nears</label> -->
      <!--   <div id='near-toggle'> -->
      <!--     <input id='near-checkbox' type='checkbox' value='v'> -->
      <!--   </div> -->
      <!-- </div> -->

        <!-- 2D structure -->
        <div class='span6'>
          <h2><i>E. coli</i> Secondary Structure</h2>
          <div id='rna-2d'></div>
        </div>

        <!-- Jmol Viewer -->
        <div class='span4 jmol-viewer'>
          <div id='jmol'>
            <script type="text/javascript">
              jmolInitialize("./static/jmol");
              jmolSetDocument(0);
              jmolSetAppletColor("#ffffff");
            </script>
          </div>
          <div id='info'>
          </div>
        </div>
      </div>

      <!-- Code to generate 2D structure and toggle buttons -->
      <script type='text/javascript'>
        // var jmol = jmol2D({
        //   group: {
        //     on: {
        //       overflow: function() { alert("Too many nts selected"); },
        //     },
        //   },
        // });

        var plot = Rna2D({ selection: '#rna-2d', width: 630, height: 795, })
        .interactions.visible(function(obj) { return obj.family == 'cWW' })
        .interactions.mouseover('highlight')
        .nucleotides.mouseover('highlight')
        .motifs.mouseover('highlight')
        ;
          // .brush.enabled(true);

          // nucleotides: {
          //   on: {
          //     mouseover: 'highlight',
          //   }
          // },
          // interaction: {
          //   visible: function(obj) { return obj.family == 'cWW' },
          //   on: {
          //     click: jmol.show.selection,
          //     mouseover: 'highlight',
          //   },
          // },
          // brush: {
          //   on: {
          //     update: jmol.show.selection,
          //   },
          // },
          // motif: {
          //   on: {
          //     click: function(motif) { console.log('motif', motif); },
          //     mouseover: 'highlight'
          //   },
          // },

        d3.json('data/16S-ecoli.js', function(data) {
          plot.nucleotides(data);

          d3.csv('data/16S-ecoli-interactions.csv', function(data) {
            plot.interactions(data);

            d3.json('data/2AW7_motifs.json', function(data) {
              plot.motifs(data);

              plot();
            });
          });
        });

      $('#mode-checkbox').click(function() { plot.brush.toggle(); });
      $('#cww-checkbox').click(function() { plot.interactions.toggle('cWW'); });
      $('#motif-checkbox').click(function() { plot.motifs.toggle(); });

      </script>
  </body>
</html>
